{"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../packages/toggl/src/index.ts\"],\"names\":[],\"mappings\":\"AAAA,iBA8HA;;AA9HA,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,OAAO,EAAE,OAAO,IAAI,KAAK,EAAsB,MAAM,OAAO,CAAC;AAoB7D,MAAM,CAAC,IAAM,UAAU,GAAG,UAAO,EAAU;IACzC,sBAAA,SAAS,CAAC,eAAa,EAAI,CAAC,EAAA;SAAA,CAAC;AAE/B,MAAM,CAAC,IAAM,WAAW,GAAG;IACzB,sBAAA,SAAS,CAAC,WAAW,CAAC,EAAA;SAAA,CAAC;AAoBzB,MAAM,CAAC,IAAM,YAAY,GAAG,UAAO,EAAU;IAC3C,sBAAA,GAAG,CAAC,mBAAiB,EAAI,CAAC,EAAA;SAAA,CAAC;AAE7B,MAAM,CAAC,IAAM,cAAc,GAAG;;;;;gBACtB,KAAe,SAAS,EAAE,EAAxB,IAAI,UAAA,EAAE,EAAE,QAAA,CAAiB;gBAC3B,MAAM,GAAG,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;gBAEjB,qBAAM,GAAG,CAAC,eAAe,EAAE,MAAM,CAAC,EAAA;;gBAA7D,WAAW,GAAgB,SAAkC;gBACnE,sBAAO,WAAW,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAArC,CAAqC,CAAC,EAAC;;;KAC1E,CAAC;AAEF,MAAM,CAAC,IAAM,eAAe,GAAG,UAAO,SAMrC;;QACC,sBAAA,IAAI,CACF,eAAe,EACf,IAAI,CAAC,SAAS,CAAC;gBACb,UAAU,EAAE;oBACV,YAAY,EAAE,OAAO;oBACrB,GAAG,EAAE,CAAC,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,IAAI;oBACxD,KAAK,EAAE,SAAS,CAAC,KAAK,CAAC,WAAW,EAAE;oBACpC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAClB,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,EAAE,CAClE;oBACD,WAAW,EAAE,SAAS,CAAC,WAAW;oBAClC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,EAAE;iBAC3B;aACF,CAAC,CACH,EAAA;;KAAA,CAAC;AAWJ,MAAM,CAAC,IAAM,OAAO,GAAG;IAA4B,sBAAA,SAAS,CAAC,OAAO,CAAC,EAAA;SAAA,CAAC;AAEtE,IAAM,YAAY,GAAG,UAAO,MAA0B;;;;;gBAC9C,GAAG,GAAG,iCAA+B,MAAM,CAAC,GAAK,CAAC;gBAGlD,IAAI,GAAG;oBACX,QAAQ,EAAE,KAAG,OAAO,CAAC,GAAG,CAAC,WAAa;oBACtC,QAAQ,EAAE,WAAW;iBACtB,CAAC;gBAEe,qBAAM,KAAK,CAAC,OAAO,sBAAM,MAAM,IAAE,GAAG,KAAA,EAAE,IAAI,MAAA,IAAG,EAAA;;gBAAtD,IAAI,GAAK,CAAA,SAA6C,CAAA,KAAlD;gBAEZ,sBAAO,IAAI,EAAC;;;KACb,CAAC;AAEF,IAAM,GAAG,GAAG,UAAC,QAAgB,EAAE,MAAY;IACzC,OAAA,YAAY,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,QAAA,EAAE,CAAC;AAAtD,CAAsD,CAAC;AAEzD,IAAM,IAAI,GAAG,UAAC,QAAgB,EAAE,IAAY;IAC1C,OAAA,YAAY,CAAC;QACX,GAAG,EAAE,QAAQ;QACb,MAAM,EAAE,MAAM;QACd,OAAO,EAAE,EAAE,cAAc,EAAE,kBAAkB,EAAE;QAC/C,IAAI,MAAA;KACL,CAAC;AALF,CAKE,CAAC;AAEL,IAAM,SAAS,GAAG,UAAO,QAAgB;IACvC,sBAAA,GAAG,CAAC,iBAAe,OAAO,CAAC,GAAG,CAAC,eAAe,SAAI,QAAU,CAAC,EAAA;SAAA,CAAC;AAEhE,IAAM,SAAS,GAAG,cAAM,OAAA,CAAC;IACvB,IAAI,EAAE,MAAM,EAAE;SACX,QAAQ,CAAC,EAAE,EAAE,MAAM,CAAC;SACpB,WAAW,EAAE;IAEhB,EAAE,EAAE,MAAM,EAAE,CAAC,WAAW,EAAE;CAC3B,CAAC,EANsB,CAMtB,CAAC\"}","code":"var _this = this;\r\nimport * as tslib_1 from \"tslib\";\r\nimport Moment from \"moment\";\r\nimport { default as Axios } from \"axios\";\r\nexport var getProject = function (id) { return tslib_1.__awaiter(_this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n    return [2 /*return*/, workspace(\"/projects/\" + id)];\r\n}); }); };\r\nexport var getProjects = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n    return [2 /*return*/, workspace(\"/projects\")];\r\n}); }); };\r\nexport var getTimeEntry = function (id) { return tslib_1.__awaiter(_this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n    return [2 /*return*/, get(\"/time_entries/\" + id)];\r\n}); }); };\r\nexport var getTimeEntries = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n    var _a, from, to, params, timeEntries;\r\n    return tslib_1.__generator(this, function (_b) {\r\n        switch (_b.label) {\r\n            case 0:\r\n                _a = dateRange(), from = _a.from, to = _a.to;\r\n                params = { start_date: from, end_date: to };\r\n                return [4 /*yield*/, get(\"/time_entries\", params)];\r\n            case 1:\r\n                timeEntries = _b.sent();\r\n                return [2 /*return*/, timeEntries.sort(function (a, b) { return Moment(a.start).diff(Moment(b.start)); })];\r\n        }\r\n    });\r\n}); };\r\nexport var createTimeEntry = function (timeEntry) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n    return tslib_1.__generator(this, function (_a) {\r\n        return [2 /*return*/, post(\"/time_entries\", JSON.stringify({\r\n                time_entry: {\r\n                    created_with: \"magic\",\r\n                    pid: (timeEntry.project && timeEntry.project.id) || null,\r\n                    start: timeEntry.start.toISOString(),\r\n                    duration: Math.round(Moment.duration(timeEntry.stop.diff(timeEntry.start)).asSeconds()),\r\n                    description: timeEntry.description,\r\n                    tags: timeEntry.tags || []\r\n                }\r\n            }))];\r\n    });\r\n}); };\r\nexport var getTags = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n    return [2 /*return*/, workspace(\"/tags\")];\r\n}); }); };\r\nvar togglRequest = function (config) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n    var url, auth, data;\r\n    return tslib_1.__generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                url = \"https://www.toggl.com/api/v8\" + config.url;\r\n                auth = {\r\n                    username: \"\" + process.env.TOGGL_TOKEN,\r\n                    password: \"api_token\"\r\n                };\r\n                return [4 /*yield*/, Axios.request(tslib_1.__assign({}, config, { url: url, auth: auth }))];\r\n            case 1:\r\n                data = (_a.sent()).data;\r\n                return [2 /*return*/, data];\r\n        }\r\n    });\r\n}); };\r\nvar get = function (resource, params) {\r\n    return togglRequest({ url: resource, method: \"get\", params: params });\r\n};\r\nvar post = function (resource, data) {\r\n    return togglRequest({\r\n        url: resource,\r\n        method: \"post\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        data: data\r\n    });\r\n};\r\nvar workspace = function (resource) { return tslib_1.__awaiter(_this, void 0, void 0, function () { return tslib_1.__generator(this, function (_a) {\r\n    return [2 /*return*/, get(\"/workspaces/\" + process.env.TOGGL_WORKSPACE + \"/\" + resource)];\r\n}); }); };\r\nvar dateRange = function () { return ({\r\n    from: Moment()\r\n        .subtract(60, \"days\")\r\n        .toISOString(),\r\n    to: Moment().toISOString()\r\n}); };\r\n//# sourceMappingURL=index.js.map"}
